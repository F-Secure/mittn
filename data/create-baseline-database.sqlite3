--
-- Create the Mittn baseline database for sqlite3.
-- Run as:
--
-- sqlite3 baseline.sqlite < create-baseline-database.sqlite3
--
-- The resulting file, baseline.sqlite, is your database file.
--
-- NOTE: If you ran this before the httpfuzzer was released into
-- Open Source, you need to DROP and re-CREATE the httpfuzzer_issues
-- table, and change the name of the headless scanner issues table
-- (ALTER TABLE).

CREATE TABLE headlessscanner_issues (
       -- Issues found by headlessscanner test runs
    new_issue numeric,
    issue_no INTEGER PRIMARY KEY,
    scenario_id BLOB,
    url BLOB,
    severity BLOB,
    issuetype BLOB,
    issuename BLOB,
    issuedetail BLOB,
    confidence BLOB,
    host BLOB,
    port BLOB,
    protocol BLOB,
    messagejson BLOB
);

CREATE TABLE httpfuzzer_issues (
       -- Issues found by HTTP fuzzer/injector test runs
    new_issue numeric,
    issue_no INTEGER PRIMARY KEY,
    scenario_id BLOB,
    url BLOB,
    server_protocol_error BLOB,
    server_timeout BLOB,
    server_error_text_match BLOB,
    req_method BLOB,
    req_headers BLOB,
    req_body BLOB,
    resp_statuscode BLOB,    
    resp_headers BLOB,
    resp_body BLOB,
    resp_history BLOB
);

